REM <Identity Name="Contoso" Version="1.0.0.0" Publisher="CN=Contoso Software, O=Contoso Corporation, C=US"/>

param ($Subject, $ExpiryDate, $CertificateName)

'If expiration date is not set, use 2 weeks.
If $ExpiryDate is not defined - ExpiryDate = (GetDate).AddDays(14)

MakeCert /n "CN=Contoso" /r /h 0 /eku "1.3.6.1.5.5.7.3.3,1.3.6.1.4.1.311.10.3.13" /e 05/31/2021 /sv .\cert\Contoso.pvk .\cert\Contoso.cer
Pvk2Pfx /pvk .\cert\Contoso.pvk /pi Contoso123 /spc .\cert\Contoso.cer /pfx .\cert\Contoso.pfx
Certutil -addStore TrustedPeople .\cert\Contoso.cer
MakeAppx.exe pack /d .\PhotoStoreDemoPkg /p .\bin\PhotoStoreDemo.msix /nv
SignTool sign /fd SHA256 /a /f .\cert\Contoso.pfx /p Contoso123 .\bin\PhotoStoreDemo.msix